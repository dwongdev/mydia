apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: iroh-relay-tls
  namespace: iroh-relay
spec:
  dnsNames: [cae1-1.relay.mydia.dev]
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt-prod
  secretName: iroh-relay-tls-secret
---
apiVersion: traefik.io/v1alpha1
kind: IngressRouteTCP
metadata:
  name: iroh-relay
  namespace: iroh-relay
spec:
  entryPoints: [websecure]
  routes:
    - match: HostSNI(`cae1-1.relay.mydia.dev`)
      services:
        - name: iroh-relay
          port: 443
  tls:
    passthrough: true
