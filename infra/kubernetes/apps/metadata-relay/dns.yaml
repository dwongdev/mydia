# DNS record for P2P relay (direct access, not proxied)
# This creates p2p.mydia.dev pointing directly to the server IP
# Required because iroh needs direct QUIC/UDP access
#
# Uses ExternalName service with external-dns annotations to create
# a DNS record without proxying through Cloudflare
apiVersion: v1
kind: Service
metadata:
  name: p2p-dns
  namespace: metadata-relay
  labels:
    app.kubernetes.io/name: metadata-relay
    app.kubernetes.io/component: relay-service
  annotations:
    # Tell external-dns to create this DNS record
    external-dns.alpha.kubernetes.io/hostname: p2p.mydia.dev
    # Point to the server's public IP
    external-dns.alpha.kubernetes.io/target: 149.56.129.39
    # Disable Cloudflare proxy (DNS-only mode required for TCP/UDP)
    external-dns.alpha.kubernetes.io/cloudflare-proxied: "false"
spec:
  type: ExternalName
  externalName: "149.56.129.39"
